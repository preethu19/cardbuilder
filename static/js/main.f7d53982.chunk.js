(this.webpackJsonpcardbuilder=this.webpackJsonpcardbuilder||[]).push([[0],{25:function(e,t,n){},32:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(11),r=n.n(o),i=n(6),s=n(7),u=n(4),l=(n(25),n(5)),b=n(10),j=n(21),d=n(2),g=function(e){var t=e.shapeProps,n=e.isSelected,a=e.onSelect,o=(e.onMove,e.onChange),r=e.useTool,i=c.a.useRef(),s=c.a.useRef();return c.a.useEffect((function(){n&&(s.current.nodes([i.current]),s.current.getLayer().batchDraw())}),[n]),Object(d.jsxs)(c.a.Fragment,{children:[Object(d.jsx)(l.e,Object(u.a)(Object(u.a)({onDblClick:a,onDblTap:a,ref:i},t),{},{draggable:!r&&n,onDragEnd:function(e){o(Object(u.a)(Object(u.a)({},t),{},{x:e.target.x(),y:e.target.y()}))},onTransformEnd:function(e){var n=i.current,a=n.scaleX(),c=n.scaleY();n.getAbsoluteTransform().getMatrix();console.log(n.rotation()),n.scaleX(1),n.scaleY(1),o(Object(u.a)(Object(u.a)({},t),{},{x:n.x(),y:n.y(),width:Math.max(5,n.width()*a),height:Math.max(n.height()*c),rotation:n.rotation()}))}})),n&&Object(d.jsx)(l.h,{ref:s,boundBoxFunc:function(e,t){return t.width<5||t.height<5?e:t}})]})},f=function(e){var t=e.shapeProps,n=e.isSelected,a=e.onSelect,o=(e.onMove,e.onChange),r=e.useTool,i=c.a.useRef(),s=c.a.useRef();return c.a.useEffect((function(){n&&(s.current.nodes([i.current]),s.current.getLayer().batchDraw())}),[n]),Object(d.jsxs)(c.a.Fragment,{children:[Object(d.jsx)(l.a,Object(u.a)(Object(u.a)({onDblClick:a,onDblTap:a,ref:i},t),{},{draggable:!r&&n,onDragEnd:function(e){o(Object(u.a)(Object(u.a)({},t),{},{x:e.target.x(),y:e.target.y()}))},onTransformEnd:function(e){var n=i.current,a=n.scaleX(),c=n.scaleY();n.scaleX(1),n.scaleY(1),o(Object(u.a)(Object(u.a)({},t),{},{x:n.x(),y:n.y(),radius:Math.max(n.radius()*a,n.radius()*c),rotation:n.rotation()}))}})),n&&Object(d.jsx)(l.h,{ref:s,boundBoxFunc:function(e,t){return t.radius<5?e:t}})]})},h=function(e){var t=e.shapeProps,n=e.isSelected,a=e.onSelect,o=(e.onMove,e.onChange),r=e.useTool,i=c.a.useRef(),s=c.a.useRef();return c.a.useEffect((function(){n&&(s.current.nodes([i.current]),s.current.getLayer().batchDraw())}),[n]),Object(d.jsxs)(c.a.Fragment,{children:[Object(d.jsx)(l.g,Object(u.a)(Object(u.a)({onDblClick:a,onDblTap:a,ref:i},t),{},{draggable:!r&&n,onDragEnd:function(e){o(Object(u.a)(Object(u.a)({},t),{},{x:e.target.x(),y:e.target.y()}))},onTransformEnd:function(e){var n=i.current,a=n.scaleX(),c=n.scaleY();n.scaleX(1),n.scaleY(1),o(Object(u.a)(Object(u.a)({},t),{},{x:n.x(),y:n.y(),width:Math.max(5,n.width()*a),height:Math.max(n.height()*c),rotation:n.rotation()}))}})),n&&Object(d.jsx)(l.h,{ref:s,boundBoxFunc:function(e,t){return t.width<5||t.height<5?e:t}})]})},O=function(e){var t=e.shapeProps,n=e.isSelected,a=e.onSelect,o=(e.onMove,e.onChange),r=e.points,i=e.tool,s=e.useTool,b=c.a.useRef(),j=c.a.useRef();return c.a.useEffect((function(){n&&(j.current.nodes([b.current]),j.current.getLayer().batchDraw())}),[n]),Object(d.jsxs)(c.a.Fragment,{children:[Object(d.jsx)(l.d,Object(u.a)(Object(u.a)({onDblClick:a,onDblTap:a,ref:b},t),{},{points:r,stroke:"#df4b26",strokeWidth:5,tension:.5,lineCap:"round",draggable:!s&&n,globalCompositeOperation:"eraser"===i?"destination-out":"source-over",onDragEnd:function(e){o(Object(u.a)(Object(u.a)({},t),{},{x:e.target.x(),y:e.target.y()}))},onTransformEnd:function(e){var n=b.current,a=n.scaleX(),c=n.scaleY();n.scaleX(1),n.scaleY(1);for(var r=[],i=0;i<t.points.length;i+=2)r=r.concat([t.points[i]*a,t.points[i+1]*c]);o(Object(u.a)(Object(u.a)({},t),{},{points:r,rotation:n.rotation()}))}})),n&&Object(d.jsx)(l.h,{ref:j,boundBoxFunc:function(e,t){return t.width<5||t.height<5?e:t}})]})},x=[{shapes:[],lines:[]}],p=0;function v(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=(t[0],t[1],Object(a.useState)([])),o=Object(s.a)(n,2),r=(o[0],o[1],Object(a.useState)([])),v=Object(s.a)(r,2),y=v[0],S=v[1],m=Object(a.useState)(null),w=Object(s.a)(m,2),k=w[0],T=w[1],C=Object(a.useState)(!1),D=Object(s.a)(C,2),P=D[0],E=D[1],M=Object(a.useState)(null),R=Object(s.a)(M,2),X=R[0],Y=R[1],F=c.a.useState(""),W=Object(s.a)(F,2),B=W[0],I=W[1],H=c.a.useState([]),J=Object(s.a)(H,2),L=J[0],z=J[1],N=c.a.useRef(!1),q=Object(a.useState)(!1),A=Object(s.a)(q,2),U=A[0],V=A[1],G=Object(a.useState)(!1),K=Object(s.a)(G,2),Q=K[0],Z=K[1],$=Object(a.useState)({scale:1,x:0,y:0}),_=Object(s.a)($,2),ee=_[0],te=_[1],ne=Object(a.useState)([]),ae=Object(s.a)(ne,2),ce=ae[0],oe=ae[1],re=Object(a.useState)([]),ie=Object(s.a)(re,2),se=ie[0],ue=ie[1],le=function(e,t){var n=window.innerWidth/e,a=window.innerHeight/t;oe([]),ue([]);for(var c=function(e){oe((function(t){return[].concat(Object(i.a)(t),[[0,e,window.innerWidth,e]])}))},o=0;o<window.innerHeight;o+=a)c(o);for(var r=function(e){ue((function(t){return[].concat(Object(i.a)(t),[[e,0,e,window.innerHeight]])}))},s=0;s<window.innerWidth;s+=n)r(s)},be=function(e){if(U){N.current=!0;var t=e.target.getStage().getPointerPosition();z([].concat(Object(i.a)(L),[{tool:B,points:[t.x,t.y],name:"line",x:0,y:0,id:Object(b.v4)()}])),S([].concat(Object(i.a)(y),[{tool:B,points:[t.x,t.y],name:"line",index:L.length,x:e.target.x(),y:e.target.y(),id:Object(b.v4)()}])),Z(!0)}ge(e)},je=function(e){if(U&&Q){if(!N.current)return;var t=e.target.getStage().getPointerPosition(),n=L[L.length-1];n.points=n.points.concat([t.x,t.y]),L.splice(L.length-1,1,n),z(L.concat())}},de=function(){U&&(N.current=!1,Z(!1),x=(x=x.slice(0,p+1)).concat([{shapes:y,lines:L}]),p+=1)},ge=function(e){e.target===e.target.getStage()&&T(null),E(!1)},fe=Object(a.useRef)(null),he=function(e){S((function(t){return t.filter((function(t,n){return t.id!==e.id}))})),S((function(t){return[].concat(Object(i.a)(t),[e])})),x=(x=x.slice(0,p+1)).concat([{shapes:[].concat(Object(i.a)(y),[e]),lines:L}]),p+=1};return Object(a.useEffect)((function(){var e=JSON.parse(localStorage.getItem("data"));e&&(z(e[1]),S(e[0]),x=[{shapes:e[0],lines:e[1]}]),le(10,5)}),[]),Object(d.jsx)(d.Fragment,{children:Object(d.jsx)(l.f,{width:window.innerWidth,height:window.innerHeight,ref:fe,onTouchStart:function(e){ge(e),be(e)},onMouseDown:be,onTouchEnd:de,onMousemove:je,onTouchMove:je,onMouseup:de,onWheel:function(e){e.evt.preventDefault();var t=e.target.getStage(),n=t.scaleX(),a=t.getPointerPosition().x/n-t.x()/n,c=t.getPointerPosition().y/n-t.y()/n,o=e.evt.deltaY<0?1.2*n:n/1.2,r=(t.getPointerPosition().x/o-a)*o,i=(t.getPointerPosition().y/o-c)*o;o<1||r>=0||i>=0?(te({scale:1,x:0,y:0}),le(10,5)):(te({scale:o,x:r,y:i}),le(20*parseInt(o),10*parseInt(o)))},scaleX:ee.scale,scaleY:ee.scale,x:ee.x,y:ee.y,children:Object(d.jsxs)(l.c,{children:[ce.map((function(e,t){return Object(d.jsx)(l.d,{strokeWidth:1,stroke:"gray",points:e},t)})),se.map((function(e,t){return Object(d.jsx)(l.d,{strokeWidth:1,stroke:"gray",points:e},t)})),y.map((function(e,t){return"rectangle"==e.name?Object(d.jsx)(g,{shapeProps:e,isSelected:e.id===k,onSelect:function(){V(!1),he(e),T(e.id)},onMove:function(){return he(e)},onChange:function(e){var n=y.slice();n[t]=e,S(n),x=(x=x.slice(0,p+1)).concat([{shapes:n,lines:L}]),p+=1},useTool:U},t):"circle"==e.name?Object(d.jsx)(f,{shapeProps:e,isSelected:e.id===k,onSelect:function(){V(!1),he(e),T(e.id)},onMove:function(){return he(e)},onChange:function(e){var n=y.slice();n[t]=e,S(n),x=(x=x.slice(0,p+1)).concat([{shapes:n,lines:L}]),p+=1},useTool:U},t):"text"==e.name?Object(d.jsx)(h,{shapeProps:e,isSelected:e.id===k,onSelect:function(){V(!1),he(e),T(e.id),Y(e),E(!P)},onMove:function(){return he(e)},onChange:function(e){var n=y.slice();n[t]=e,S(n),x=(x=x.slice(0,p+1)).concat([{shapes:n,lines:L}]),p+=1},useTool:U},t):"line"==e.name?Object(d.jsx)(O,{points:L[e.index].points,tool:L[e.index].tool,shapeProps:L[e.index],isSelected:L[e.index].id===k,onSelect:function(){V(!1),he(e),T(L[e.index].id)},onMove:function(){return he(e)},onChange:function(t){var n=L.slice();n[e.index]=t,z(n),x=(x=x.slice(0,p+1)).concat([{shapes:y,lines:n}]),p+=1},useTool:U},t):void 0})),Object(d.jsx)(l.a,{name:"draggableCircle1",x:50,y:70,radius:25,stroke:"black",id:"circle1"}),Object(d.jsx)(l.a,{name:"draggableCircle",x:50,y:70,radius:25,stroke:"black",draggable:!U,id:"circle2",onDragEnd:function(e){var t={x:e.target.x(),y:e.target.y(),radius:25,stroke:"black",id:Object(b.v4)(),fill:"red",name:"circle"};S((function(e){return[].concat(Object(i.a)(e),[t])})),console.log(y),fe.current.findOne(".draggableCircle").position({x:50,y:70}),x=(x=x.slice(0,p+1)).concat([{shapes:[].concat(Object(i.a)(y),[t]),lines:L}]),p+=1}}),Object(d.jsx)(l.e,{x:25,y:100,width:50,height:50,stroke:"black",id:"rect1"}),Object(d.jsx)(l.e,{name:"draggableRect",x:25,y:100,width:50,height:50,stroke:"black",id:"rect1",draggable:!U,onDragEnd:function(e){var t={x:e.target.x(),y:e.target.y(),stroke:"black",width:50,height:50,id:Object(b.v4)(),fill:"green",name:"rectangle"};S((function(e){return[].concat(Object(i.a)(e),[t])})),fe.current.findOne(".draggableRect").position({x:25,y:100}),x=(x=x.slice(0,p+1)).concat([{shapes:[].concat(Object(i.a)(y),[t]),lines:L}]),p+=1}}),Object(d.jsx)(l.g,{fontSize:50,text:"T",width:40,height:100,x:35,y:160}),Object(d.jsx)(l.g,{name:"draggableText",x:35,y:160,text:"T",fontSize:50,width:40,height:100,draggable:!U,onDragEnd:function(e){var t={x:e.target.x(),y:e.target.y(),id:Object(b.v4)(),text:"T",width:40,textEditVisible:!0,height:100,fontSize:50,name:"text"};S((function(e){return[].concat(Object(i.a)(e),[t])})),fe.current.findOne(".draggableText").position({x:35,y:160}),x=(x=x.slice(0,p+1)).concat([{shapes:[].concat(Object(i.a)(y),[t]),lines:L}]),p+=1}}),Object(d.jsxs)(j.a,{children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("input",{type:"button",value:"Undo",onClick:function(){if(console.log("undo"),0!==p){var e=x[p-=1];z(e.lines),S(e.shapes)}}}),Object(d.jsx)("input",{type:"button",value:"Redo",onClick:function(){if(console.log("redo"),p!==x.length-1){var e=x[p+=1];z(e.lines),S(e.shapes)}}}),Object(d.jsx)("input",{type:"button",value:"Save",onClick:function(){var e=JSON.stringify([y,L]);localStorage.setItem("data",e)}}),Object(d.jsx)("br",{}),Object(d.jsx)("input",{type:"button",value:"Pencil",style:"pen"==B&&U?{backgroundColor:"aqua"}:null,onClick:function(){I("pen"),V(!U)}})]}),P?Object(d.jsx)("textarea",{value:X.text,onChange:function(e){var t={};Y((function(t){return Object(u.a)(Object(u.a)({},t),{},{text:e.target.value})})),S(y.map((function(n){return n.id==k?t=Object(u.a)(Object(u.a)({},n),{},{text:e.target.value}):n}))),x=(x=x.slice(0,p+1)).concat([{shapes:[].concat(Object(i.a)(y),[t]),lines:L}]),p+=1}}):null]})]})})})}r.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(v,{})}),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.f7d53982.chunk.js.map